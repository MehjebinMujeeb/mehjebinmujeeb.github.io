<!DOCTYPE html>
<html lang="en">
<!--
    <a href="https://www.flaticon.com/free-icons/done" title="done icons">Done icons created by Artem Buz - Flaticon</a>
-->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/css/main.css" rel="stylesheet" type="text/css">
    
    <title>Meha</title>


    <script type="text/javascript" >

        var taskArray = [];

        function swapItemState(id)
        {
            
            var obj = taskArray[id];

            if(obj.state === 'item-inprogress')
            {
                obj.state = 'item-done';
            }
            else
            {
                obj.state = 'item-inprogress';
            }
            

            fillList();
        }

        function fillList() {
            var taskList = document.getElementsByClassName("todo-list")[0];
            taskList.innerHTML = "";

            for (var taskObj of taskArray)
            {

                var taskItem = '<div onclick="swapItemState(' + taskObj.id + ')" id="' +
                     taskObj.id + '" class="todo-item ' + taskObj.state  +  '" >' +
                     '<img src="/images/accept.png"></img><p>' +
                     taskObj.title +
                     '</p></div>';

                taskList.innerHTML = taskList.innerHTML + taskItem;
            }

            if(taskArray.length == 0)
            {
                taskList.innerHTML = "<div class=\"no-task-image\"></div>"
            }
        }


        function addTask() {
            var taskTextBox = document.getElementById("task-text");
            var text = taskTextBox.value;

            // Prevent adding it the text box is empty;
            text = text.trim();

            if(text.length <= 0)
            {
                return;
            }

            var taskObj = {
                id: taskArray.length,
                title: text,
                state: 'item-inprogress'
            }

            taskArray.push(taskObj)

            // console.table(taskArray);
            taskTextBox.value = "";

            fillList();
            
        }

        function clearTask() {
            taskArray = [];
            fillList();
        }



        var selectedDuration = 1200;
        var totalSeconds = 1200; // 20 mins in Seconds
        var timer;
        
        isPaused = true;
        isFirstTime = true;

        function playAndPause()
        {
            var playButton = document.getElementById("play-button");
            isPaused = !isPaused;

            console.log(isPaused);
            console.log(isFirstTime);

            if(isPaused)
            {
                playButton.classList.remove("pause-btn");
                playButton.classList.add("play-btn");
            }
            else
            {
                playButton.classList.remove("play-btn");
                playButton.classList.add("pause-btn");
            }

            if(isFirstTime)
            {
                isFirstTime = false;
                timerFunc();
            }
        }

        function timerFunc() {
            var clock = document.getElementById("clock");
            timer = setInterval(function(){
                var mins = Math.floor(totalSeconds/60);
                var secs = totalSeconds % 60;
                
                if(mins < 10)
                {
                    mins = "0" + mins
                }

                if(secs < 10)
                {
                    secs = "0" + secs
                }

                var clockText = mins + ":" + secs;

                clock.innerHTML = clockText;

                if(isPaused)
                {
                    return;
                }

                totalSeconds --;

                if(totalSeconds <= 0)
                {
                    resetTimer();
                }
                
            }, 1000);

        }

        function selectTimerDuration(duration) {
            var clock = document.getElementById("clock");
            resetTimer();
            selectedDuration = duration;
            totalSeconds = duration;
            var mins = Math.floor(totalSeconds/60);
            var secs = totalSeconds % 60;
            
            if(mins < 10)
            {
                mins = "0" + mins
            }

            if(secs < 10)
            {
                secs = "0" + secs
            }
            var clockText = mins + ":" + secs;
            clock.innerHTML = clockText;
        }

        function resetTimer(){
            var clock = document.getElementById("clock");
            if(timer === undefined || timer === null)
            {
                return;
            }

            clearTimeout(timer);
            timer = null;

            totalSeconds = selectedDuration;
            var mins = Math.floor(totalSeconds/60);
            var secs = totalSeconds % 60;
            
            if(mins < 10)
            {
                mins = "0" + mins
            }

            if(secs < 10)
            {
                secs = "0" + secs
            }
            var clockText = mins + ":" + secs;
            clock.innerHTML = clockText;

           isFirstTime = true;
           isPaused = true;
           var playButton = document.getElementById("play-button");
           playButton.classList.remove("pause-btn");
           playButton.classList.add("play-btn");
        }


    </script>
   
</head>
<body>

    <!-- Navbar Start -->
    <nav>
        <a href="/" >
            <img 
              class="navbar-logo" 
              src="images/logo.svg"
            ></img>
        </a>

        <span class="nav-links">
          <a class="nav-link nav-btn" href="#section4" >00:00</a>
        </span>
    </nav>
    <!-- Navbar Ends -->

    <section id="home">  
        <br>
        <br>
        <br>
        <br>

        <!-- START OF MAIN WINDOW -->
        <div class="main-window"> 

        <!-- START OF TIMER WINDOW -->
        <div class="timer-window" >
            <h1>Time to Work!</h1>
            <h2 id="clock" class="clock-text">20:00</h2>
            <div class="timers-section">
                <button onclick="selectTimerDuration(1200)">20:00</button>
                <button onclick="selectTimerDuration(1500)">25:00</button>
                <button onclick="selectTimerDuration(1800)">30:00</button>
            </div>
            <div class="timer-btns">
                <button onclick="playAndPause()" id="play-button" class="round-btn play-btn" ></button>
                <button onclick="resetTimer()" class="round-btn redo-btn" ></button>
            </div>
        </div> <!-- END OF TIMER WINDOW -->

        <!-- START OF MAIN WINDOW -->
        <div class="todo-window" >
          
            <input type="text" class="text" id="task-text" placeholder="Task"/>
            <div style="padding: 16px 16px 16px 16px;"></div>
            <input type="button" id="addTaskBtn" class="button btn-blue" value="Add Task"/>
            <input type="button" id="clearTaskBtn" class="button btn-red" value="Clear Task"/>
            <div style="padding: 16px 16px 16px 16px;"></div>
            <div class="todo-list">
                <div class="no-task-image">
                    <!-- <img src="/images/no-task.png" height="80px" >
                    <img src="/images/no-task-2.png" height="80px" >
                    <img src="/images/no-task-3.png" height="80px" > -->
                </div>
                <!-- <div class="todo-item item-inprogress" >
                    <img src="/images/accept.png"></img>
                    <p>Complete Reading Poems, Then do something , something</p>
                </div>
                <div class="todo-item item-done">
                    <img src="/images/accept.png"></img>
                    <p>Pay the bills</p>
                </div>
                <div class="todo-item item-done">
                    <img src="/images/accept.png"></img>
                    <p>Complete Reading Poems, Then do something , something</p>
                </div>
                <div class="todo-item item-inprogress">
                    <img src="/images/accept.png"></img>
                    <p>Pay the bills</p>
                </div>
                <div class="todo-item item-done">
                    <img src="/images/accept.png"></img>
                    <p>Complete Reading Poems, Then do something , something</p>
                </div>
                <div class="todo-item item-inprogress">
                    <img src="/images/accept.png"></img>
                    <p>Pay the bills</p>
                </div> -->
            </div>
        </div> <!-- END OF TODO WINDOW -->

     

    
        </div> <!-- END OF MAIN WINDOW -->

    </section>


</body>
<script>
    //  Adding event listners
    document.getElementById("addTaskBtn").addEventListener('click', addTask);
    document.getElementById("clearTaskBtn").addEventListener('click', clearTask);
</script>
</html>
